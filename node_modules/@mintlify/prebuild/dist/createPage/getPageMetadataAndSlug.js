import { slugToTitle } from '@mintlify/common';
import matter from 'gray-matter';
import { removeLeadingSlash } from '../fs/removeLeadingSlash.js';
import { optionallyAddLeadingSlash } from '../generate.js';
import { getOpenApiTitleAndDescription } from './getOpenApiTitleAndDescription.js';
export const getPageMetadataAndSlug = (pagePath, pageContent, openApiFiles) => {
    const { data: metadata } = matter(pageContent);
    // Replace .mdx, so we can pass file paths into this function
    const slug = pagePath.replace(/\.mdx?$/, '');
    const defaultTitle = slugToTitle(slug);
    // Append data from OpenAPI if it exists
    const { title, description } = getOpenApiTitleAndDescription(openApiFiles, metadata.openapi);
    const pageMetadata = {
        title: title ?? defaultTitle,
        description,
        ...metadata,
        href: optionallyAddLeadingSlash(slug),
    };
    return {
        pageMetadata,
        slug: removeLeadingSlash(slug),
    };
};
